<!DOCTYPE html>
<html>
<body>
  <section class="page" id="applications">
    <div class="container">

      <section>
        <h2 data-bind="ltext: 'auth-admin.required-fields-obligatory.title'"></h2>
        <input type="checkbox" class="form-input" id="required-fields-obligatory-enabled" data-test-id="required-fields-obligatory-enabled"
               data-bind="checked: organization.appRequiredFieldsFillingObligatory, enable: lupapisteApp.models.globalAuthModel.ok('set-organization-app-required-fields-filling-obligatory')" />
        <label for="required-fields-obligatory-enabled" class="form-label" data-bind="ltext: 'auth-admin.required-fields-obligatory.enabled'"></label>
      </section>

      <section>
        <h2 data-bind="ltext: 'auth-admin.tags'"></h2>
        <!-- ko if: lupapisteApp.models.currentUser.loaded() -->
        <div data-bind="component: 'tags-editor'"></div>
        <!-- /ko -->
      </section>

      <section>
        <h2 data-bind="ltext: 'auth-admin.selected-operations'"></h2>
        <table data-test-id="organization-selected-operations">
        <!-- ko foreach: organization.selectedOperations -->
          <thead>
            <tr>
              <th data-bind="ltext: permitType"></th>
            </tr>
          </thead>
          <tbody data-bind="foreach: operations">
            <tr data-bind="attr: {'data-test-op-id': id}" class="sel-op-row">
              <td data-bind="text: text"></td>
            </tr>
          </tbody>
          <!-- /ko -->
        </table>
        <div data-bind="with: organization">
          <button data-bind="click: $root.editSelectedOperationsModel.open, ltext: 'edit', enable: lupapisteApp.models.globalAuthModel.ok('set-organization-selected-operations')"
                  class="btn-primary" data-test-id="authadmin-edit-selected-operations"></button>
        </div>
      </section>

      <section>
        <h2 data-bind="ltext: 'auth-admin.operations-attachments'"></h2>
        <table data-test-id="organization-operations-attachments">
          <!-- ko foreach: organization.operationsAttachments -->
          <!-- ko if: $data.operations && operations.length -->
          <thead>
            <tr>
              <th data-bind="ltext: 'auth-admin.operations-attachments.operation'"></th>
              <th data-bind="visible: $root.organization.tosFunctionVisible, ltext: 'tos.function'"></th>
              <th data-bind="ltext: 'auth-admin.operations-attachments.attachments'"></th>
              <th data-bind="ltext: 'auth-admin.actions'"></th>
            </tr>
          </thead>
          <tbody data-bind="foreach: operations">
            <tr data-bind="attr: {'data-op-id': id}">
              <td><span data-bind="ltext: permitType"></span> / <span data-bind="text: text"></span></td>
              <td data-bind="visible: $root.organization.tosFunctionVisible">
                <select data-bind="options: $root.organization.tosFunctions,
                                   optionsText: 'name',
                                   optionsValue: 'code',
                                   value: tosFunction,
                                   valueAllowUnset: true" ></select>
              </td>
              <td data-bind="foreach: attachments">
                <span data-bind="visible: $index">, </span>
                <span data-bind="text: text"></span>
              </td>
              <td>
                <span data-bind="visible: lupapisteApp.models.globalAuthModel.ok('organization-operations-attachments')">
                  [<a href="#" data-bind="click: $root.editAttachments.open, ltext: 'edit'" data-test-id="add-operations-attachments" class="modal"></a>]
                </span>
              </td>
            </tr>
          </tbody>
          <!-- /ko -->
          <!-- /ko -->
        </table>
      </section>

    </div> <!-- container -->



    <div id="dialog-edit-selected-operations" class="window autosized selectm-dialog">
      <div class="dialog-header">
        <p data-bind="ltext: 'auth-admin.selected-operations'"></p>
        <p class="dialog-close close lupicon-remove"></p>
      </div>
      <div class="dialog-content">
        <div class="selected-operation-templates"></div>
      </div>
    </div>

    <div id="dialog-edit-attachments" class="window autosized selectm-dialog">
      <div class="dialog-header">
        <p data-bind="text: $root.editAttachments.opName"></p>
        <p class="dialog-close close lupicon-remove"></p>
      </div>
      <div class="dialog-content">
        <div class="attachment-templates"></div>
      </div>
    </div>

  </section>
</body>
</html>
