<!DOCTYPE html>
<html lang="en">
<body>
  <section class="page container" id="mypage">

    <div class="">
      <form id="own-info-form">
        <a data-bind="ltext: 'back'" href="#"
          onclick="javascript:history.go(-1);return false;" class="btn"></a>
        <div class="own-info form-group">
          <h2 data-bind="ltext: 'mypage.title'"></h2>
          <div class="form-entry">
            <label data-bind="ltext: 'userinfo.firstName'"
              for="firstName" class="form-label"></label> <input
              data-bind="value: firstName, attr: {placeholder: loc('userinfo.firstName')}, valueUpdate: 'afterkeydown'"
              id="firstName" type="text" class="form-input"></input>
          </div>

          <div class="form-entry">
            <label data-bind="ltext: 'userinfo.lastName'" for="lastName"
              class="form-label"></label> <input
              data-bind="value: lastName, attr: {placeholder: loc('userinfo.lastName')}, valueUpdate: 'afterkeydown'"
              id="lastName" type="text" class="form-input"></input>
          </div>

          <div class="form-entry">
            <label data-bind="ltext: 'userinfo.phone'" for="phone"
              class="form-label"></label> <input
              data-bind="value: phone, attr: {placeholder: loc('userinfo.phone')}, valueUpdate: 'afterkeydown'"
              id="phone" type="text" class="form-input"></input>
          </div>
          
          <div class="form-entry">
            <label data-bind="ltext: 'userinfo.street'" for="street"
              class="form-label"></label> <input
              data-bind="value: street, attr: {placeholder: loc('userinfo.street')}, valueUpdate: 'afterkeydown'"
              id="street" type="text" class="form-input"></input>
          </div>
          <div class="form-entry">
            <label data-bind="ltext: 'userinfo.zip'" for="zip"
              class="form-label"></label> <input
              data-bind="value: zip, attr: {placeholder: loc('userinfo.zip')}, valueUpdate: 'afterkeydown'"
              id="zip" type="text" class="form-input"></input>
          </div>
          <div class="form-entry">
            <label data-bind="ltext: 'userinfo.city'" for="city"
              class="form-label"></label> <input
              data-bind="value: city, attr: {placeholder: loc('userinfo.city')}, valueUpdate: 'afterkeydown'"
              id="city" type="text" class="form-input"></input>
          </div>
          
          <div data-bind="if: features.enabled('architect-info')">
            <div class="form-entry feature">
              <label
                data-bind="ltext: 'userinfo.architect.company.name'"
                for="architect.company.name" class="form-label"></label>
              <input data-bind="value: companyName"
                id="architect.company.name" type="text"
                class="form-input"></input>
            </div>
            <div class="form-entry feature">
              <label
                data-bind="ltext: 'userinfo.architect.company.id'"
                for="architect.company.id" class="form-label"></label>
              <input data-bind="value: companyId"
                id="architect.company.id" type="text"
                class="form-input"></input>
            </div>

            <div class="form-entry architect-toggle feature">
              <input data-bind="checked: architect" id="architect"
                type="checkbox" class="form-input"></input> <label
                data-bind="ltext: 'userinfo.architect'" for="architect"
                class="form-label"></label>
            </div>
          </div>
        </div>

        <div data-bind="visible: architect">
          <div data-bind="if: features.enabled('architect-info')">
            <div class="architect-info form-group feature">
              <h2 data-bind="ltext: 'architect.experience.title'"></h2>
              
              <div class="form-entry">
                <label data-bind="ltext: 'userinfo.architect.degree'"
                  for="architect.degree" class="form-label"></label> <input
                  data-bind="value: degree" id="architect.degree"
                  type="text" class="form-input"></input>
              </div>

              <div class="form-entry">
                <label data-bind="ltext: 'userinfo.architect.fise'"
                  for="architect.fise" class="form-label"></label> <input
                  data-bind="value: fise" id="architect.fise"
                  type="text" class="form-input"></input>
              </div>

              <div class="form-entry clear">
                <div
                  data-bind="visible: !hasAttachments(), ltext: 'userinfo.architect.attachments.no-attachments'"></div>
                <table data-bind="visible: hasAttachments"
                  class="architect-attachments">
                  <thead>
                    <tr>
                      <th
                        data-bind="ltext: 'userinfo.architect.attachments.name'"></th>
                      <th
                        data-bind="ltext: 'userinfo.architect.attachments.file'"></th>
                    </tr>
                  </thead>
                  <tbody data-bind="foreach: attachments">
                    <tr>
                      <td
                        data-bind="attr: {'data-test-id': $data['attachment-id']}">
                        <div
                          data-bind="text: loc(['userinfo.architect.attachments.name', $data['attachment-type']])"
                          data-test-id="attachment-type"></div>
                        <div data-bind="text: filename"
                          data-test-id="filename"></div>
                      </td>
                      <td><a
                        data-bind="ltext: 'userinfo.architect.attachments.load',
                                    attr: {href: '/api/raw/download-user-attachment?attachment-id=' + $data['attachment-id']}"
                        data-test-id="load" href="#" target="_blank">
                      </a> <a
                        data-bind="ltext: 'userinfo.architect.attachments.remove',
                                    click: $parent.remove"
                        data-test-id="remove" href="#"> </a></td>
                    </tr>
                  </tbody>
                </table>
                <button
                  data-bind="click: add, ltext: 'userinfo.architect.attachments.add'"></button>
              </div>
            </div>
          </div>
        </div>
        <!-- feature flagging -->

        <button data-bind="ltext: 'save', enable: ok, click: save"
          type="button" class="btn btn-primary"
          data-test-id="save-my-userinfo"></button>
        <p class="context-error"
          data-bind="visible: error() != null, ltext: error"></p>
        <span data-bind="visible: !error() && saved, ltext: 'saved'"
          style="font-weight: bold; color: green;"
          data-test-id="save-my-userinfo-ok"></span> <img
          class="own-info-ajax-loader" style="display: none"
          src="/img/ajax-loader-12.gif" alt="..." width="12" height="12" />
      </form>
    </div>

    <div>
      <form id="pw-form">
        <div class="form-group">
          <h2 data-bind="ltext: 'userinfo.changePassword'"></h2>

          <div class="form-entry">
            <label data-bind="ltext: 'userinfo.oldPassword'"
              for="oldPassword" class="form-label"></label> <input
              data-bind="value: oldPassword, valueUpdate: 'afterkeydown', attr: {placeholder: loc('userinfo.oldPassword')}"
              id="oldPassword" type="password" class="form-input"></input>
          </div>
          <div class="form-entry">
            <label data-bind="ltext: 'userinfo.newPassword'"
              for="newPassword" class="form-label">:</label> <input
              data-bind="value: newPassword, valueUpdate: 'afterkeydown', attr: {placeholder: loc('userinfo.newPassword')}"
              id="newPassword" type="password" class="form-input"></input>
            <span
              data-bind="text: loc(['mypage.quality', quality()]), attr: {'class': quality}, visible: newPassword().length > 0"></span>
          </div>
          <div class="form-entry">
            <label data-bind="ltext: 'userinfo.newPassword2'"
              for="newPassword2" class="form-label">:</label> <input
              data-bind="value: newPassword2, valueUpdate: 'afterkeydown', attr: {placeholder: loc('userinfo.newPassword2')}"
              id="newPassword2" type="password" class="form-input"></input>
            <span data-bind="visible: noMatch, ltext: 'mypage.noMatch'"
              style="color: gray; font-style: italic;"></span>
          </div>
          <div class="clear"></div>
          <button
            data-bind="click: save, enable: ok, ltext: 'userinfo.changePassword'"
            type="button" class="btn btn-primary"
            data-test-id="change-my-password"></button>
          <p class="context-error"
            data-bind="visible: error() != null, ltext: error"
            class="context-error"></p>
          <span
            data-bind="visible: !error() && saved, ltext: 'mypage.passwordChanged'"
            style="font-weight: bold; color: green;"
            data-test-id="change-my-passwor-ok"></span> <img
            class="pw-ajax-loader" style="display: none"
            src="/img/ajax-loader-12.gif" alt="..." width="12"
            height="12" />
        </div>
      </form>
    </div>

    <div id="dialog-userinfo-architect-upload" class="window autosized">
      <div class="dialog-header">
        <p data-bind="ltext: 'userinfo.architect.upload.title'"></p>
        <p class="dialog-close close">X</p>
      </div>
      <div class="dialog-content">

        <div
          data-bind="visible: state() < stateSending, ltext: 'userinfo.architect.upload.state.init'"></div>
        <div
          data-bind="visible: state() === stateSending, ltext: 'userinfo.architect.upload.state.sending'"></div>
        <div
          data-bind="visible: state() === stateDone, ltext: 'userinfo.architect.upload.state.ready'"></div>
        <div
          data-bind="visible: state() === stateError, ltext: 'userinfo.architect.upload.state.error'"></div>

        <form>

          <select
            data-bind="options: availableAttachmentTypes, value: attachmentType, optionsText: 'name', optionsCaption: loc('userinfo.architect.qualification.choose')"></select>
          <div class="clear"></div>
          <input type="file" name="files[]" class="file-upload"></input>
          <input
            data-bind="attr: {value: attachmentType() && attachmentType().id}"
            type="hidden" name="attachmentType"></input> <input
            data-bind="attr: {value: csrf}" type="hidden"
            name="__anti-forgery-token"></input>
        </form>

        <div>
          <div data-bind="visible: !filename()">
            <p data-bind="ltext: 'userinfo.architect.upload.no-file'"></p>
          </div>
          <div data-bind="visible: filename">
            <p>
              <span
                data-bind="ltext: 'userinfo.architect.upload.filename'"></span>
              <span data-bind="text: filename"></span> <span
                data-bind="size: filesize"></span>
            </p>
          </div>
        </div>

        <button
          data-bind="click: upload,
                           visible: state() < stateSending,
                           enable: canStart,
                           ltext: 'userinfo.architect.upload.ok'"
          data-test-id="userinfo-upload-ok"
          class="btn btn-primary btn-dialog"></button>
        <button
          data-bind="visible: state() == stateDone,
                           ltext: 'userinfo.architect.upload.ready'"
          data-test-id="userinfo-upload-ready"
          class="btn btn-primary btn-dialog close"></button>
        <button
          data-bind="enable: state() < stateSending,
                           visible: state() < stateDone,
                           ltext: 'userinfo.architect.upload.cancel'"
          data-test-id="userinfo-upload-cancel"
          class="btn btn-dialog close"></button>

      </div>
    </div>

  </section>
</body>
</html>
