<!DOCTYPE html>
<html lang="en">
<body>
  <section class="page" id="application">
    <div class="application_summary">
      <div class="container">
        <div class="application-map-container">
          <div id="application-map" class="map map-large" style="width: 320px; height: 280px;"></div>
          <div class="application-map-actions" data-bind="with: application">
            <!-- ko if: location() -->
              <a data-bind="click: openOskariMap" class="map-search-button icon search"></a>
            <!-- /ko -->
          </div>
        </div>
        <div data-bind="with: application" class="application_summary_info">
          <h1><span data-bind="ltext: permitType"></span> <span data-bind="text: address" data-test-id="application-title" class="address"></span>
          <a class="icon"
             data-bind="ltext: 'edit', click: $root.changeLocationModel.changeLocation, visible: $root.authorization.ok('change-location')"
             data-test-id="change-location-link"></a>
          </h1>
          <!-- Property ID: -->
          <div>
            <p data-bind="ltext: 'application.property'"></p>
            <span class="application_summary_text" data-bind="propertyId: propertyId" data-test-id="application-property-id"></span>
          </div>
          <!-- State: -->
          <div>
            <p data-bind="ltext: 'application.state'">Tila:</p>
            <span
              data-bind="ltext: state, attr: {'data-test-state': state}"
              data-test-id="application-state"
              class="application_summary_text">
            </span>
          </div>
          <!-- Submitted: -->
          <div data-bind="with: $root.application.data">
            <p data-bind="ltext: 'application.submissionDate'"></p>
            <span data-bind="if: $data.submitted">
              <span data-bind="dateString: submitted" data-test-id="application-submitted-date" class="application_summary_text"></span>
            </span>
          </div>

          <!-- ID: -->
          <div>
            <p data-bind="ltext: 'application.id'"></p>
            <span
              data-bind="text: id, attr: {'data-test-value': id}"
              data-test-id="application-id"
              class="application_summary_text">
            </span>
          </div>
          <!-- Authorities: -->
          <!-- ko if: $root.authorization.ok('assign-application') -->
          <div>
            <p data-bind="ltext: 'application.assignee'"></p>
            <span class="application_summary_text">
              <select
                data-bind="options: $root.authorities,
                           optionsText: function(item) { return item.firstName + ' ' + item.lastName; },
                           optionsValue: 'id',
                           value: $root.application.assignee,
                           optionsCaption: loc('choose')"
                data-test-id="application-assigneed-authority">
              </select>
            </span>
          </div>
          <!-- /ko -->

          <!-- Operations: -->
          <div>
            <p data-bind="ltext: 'application.operations'"></p>
            <ul data-bind="foreach: operationsCount">
              <li>
                <span data-bind="visible: count > 1">
                  <span data-bind="text: count"></span>
                  <span>&#x00D7;</span>
                </span>
                <span data-bind="ltext: 'operations.' + name, attr: {'data-test-operation-id': name}" data-test-id="test-application-operation"></span>
              </li>
            </ul>
          </div>
        </div>


        <!-- Actions: -->
        <div data-bind="with: application" class="application_actions">
          <div class="muncipality-info">
            <h2 data-bind="ltext: 'application.muncipality'"></h2>
            <p data-bind="text: loc('municipality', municipality())"></p>
          </div>
          <button data-bind="click: submitApplication,    visible: $root.authorization.ok('submit-application'),     enable: $root.authorization.ok('submit-application')"     data-test-id="application-submit-btn"  class="btn btn-primary">
            <span data-bind="ltext: 'application.submitApplication'"></span>
            <span class="icon send left-align"></span>
          </button>
          <button data-bind="click: approveApplication,   visible: $root.authorization.ok('approve-application'),    enable: $root.authorization.ok('approve-application')"    data-test-id="approve-application"     class="btn btn-primary">
            <span data-bind="ltext: 'application.approveApplication'"></span>
            <span class="icon approve left-align"></span>
          </button>
          <button data-bind="click: requestForComplement, visible: $root.authorization.ok('request-for-complement'), enable: $root.authorization.ok('request-for-complement')" data-test-id="request-for-complement">
            <span data-bind="ltext: 'application.requestForComplement'"></span>
            <span class="icon complement left-align"></span>
          </button>
          <button data-bind="click: addOperation,         visible: $root.authorization.ok('add-operation'),  enable: $root.authorization.ok('add-operation')"  data-test-id="add-operation">
            <span data-bind="ltext: 'application.addOperation'"></span>
            <span class="icon add-grey left-align"></span>
          </button>
<!--           TODO: notPublicAreaTypeOperation() needs to be replaced by usage of authorization.ok(). -->
          <button data-bind="click: exportPdf,            visible: notPublicAreaTypeOperation()"  data-test-id="application-pdf-btn">
            <span data-bind="ltext: 'application.pdf'"></span>
            <span class="icon print left-align"></span>
          </button>
          <button data-bind="click: cancelApplication,    visible: $root.authorization.ok('cancel-application'),     enable: $root.authorization.ok('cancel-application')"     data-test-id="application-cancel-btn"  class="btn">
            <span data-bind="ltext: 'application.cancelApplication'"></span>
            <span class="icon remove-grey left-align"></span>
          </button>
          <button data-bind="click: stampAttachments,     visible: $root.authorization.ok('stamp-attachments'),      enable: $root.authorization.ok('stamp-attachments')"     data-test-id="application-stamp-btn"  class="btn">
            <span data-bind="ltext: 'application.stampAttachments'"></span>
            <span class="icon stamp left-align"></span>
          </button>
        </div>

        <!-- Tabs: -->
        <div class="tabs-container">
          <ul class="tabs" id="applicationTabs">
            <li><a data-bind="click: $root.application.changeTab"
                   href="#" data-target="info" data-test-id="application-open-info-tab">
                  <span data-bind="ltext: 'application.tabInfo'"></span>
                  <span data-bind="if: $root.application.nonpartyDocumentIndicator">
                    <span data-bind="text: $root.application.nonpartyDocumentIndicator"
                        id="applicationNonpartyDocumentIndicator" class="indicator"></span></span></a></li>
            <li><a data-bind="click: $root.application.changeTab"
                   href="#" data-target="parties" data-test-id="application-open-parties-tab">
                  <span data-bind="ltext: 'application.tabParties'"></span>
                  <span data-bind="if: $root.application.partyDocumentIndicator">
                    <span data-bind="text: $root.application.partyDocumentIndicator"
                          id="applicationPartyDocumentIndicator" class="indicator"></span></span></a></li>
            <li><a data-bind="click: $root.application.changeTab"
                   href="#" data-target="attachments" data-test-id="application-open-attachments-tab">
                <span data-bind="ltext: 'application.tabAttachments'"></span>
                <span data-bind="if: $root.application.attachmentsRequiringAction">
                  <span data-bind="text: $root.application.attachmentsRequiringAction"
                        id="applicationAttachmentsRequiringAction" class="indicator"></span></span></a></li>
            <li><a data-bind="click: $root.application.changeTab"
                   href="#" data-target="statement" data-test-id="application-open-statement-tab">
                  <span data-bind="ltext: 'application.tabStatement'"></span>
                  <span data-bind="if: $root.application.unseenStatements">
                    <span data-bind="text: $root.application.unseenStatements"
                          id="applicationUnseenStatements" class="indicator"></span></span></a></li>
            <li><a data-bind="click: $root.application.changeTab"
                   href="#" data-target="verdict" data-test-id="application-open-verdict-tab">
                   <span data-bind="ltext: 'application.tabVerdict'"></span>
                <span data-bind="if: $root.application.unseenVerdicts">
                  <span data-bind="text: $root.application.unseenVerdicts"
                        id="applicationUnseenVerdists" class="indicator"></span></span></a></li>
            <li><a data-bind="click: $root.application.changeTab"
                   href="#" data-target="conversation" data-test-id="application-open-conversation-tab" >
                  <span data-bind="ltext: 'application.tabConversation'"></span>
                  <span data-bind="if: $root.application.unseenComments">
                    <span data-bind="text: $root.application.unseenComments"
                          id="applicationUnseenComments" class="indicator"></span></span></a></li>
          </ul>
        </div>
      </div>
    </div>

    <div class="container">
      <div class="sidebar">
        <aside class="instructions">
            <h3 data-bind="ltext: 'help'">Ohje</h3>
            <p data-bind="ltext: 'application.helpText'"></p>
        </aside>
      </div>

      <div class="tab-content-container content">

        <div id="application-info-tab" class="tab-content">
          <h1 data-bind="ltext: 'application.tabInfo'"></h1>
          <p data-bind="ltext: 'application.applicationInfoDesc'" class="tab-info"></p>
          <p data-bind="ltext: 'required.field.desc'"></p>
          <!-- docgen generated content: -->
          <div class="application_section">
            <div id="applicationDocgen">
              <!-- This is where generated document will be placed. -->
            </div>
          </div>
          <div class="process-nav">
            <a class="btn process-next" data-bind="click: $root.application.nextTab" href="#" data-target="parties"><span data-bind="ltext: 'application.next-tab'"></span><span class="icon drill-right-orange inline-right"></span></a>
          </div>
        </div>
        <div id="application-parties-tab" class="tab-content">
          <h1 data-bind="ltext: 'application.tabParties'"></h1>
          <p data-bind="ltext: 'application.partiesDesc'" class="tab-info"></p>
          <p data-bind="ltext: 'required.field.desc'"></p>
          <div class="application_section" data-bind="with: application">
            <h2 class="application_section_header " onclick="accordion.click();">
              <span class="font-icon icon-expanded"></span> <span data-bind="ltext: 'application.basicInfo'">Hakemuksen perustiedot</span></h2>
            <div class="application_section_content content_expanded">
              <div>
                <h3 data-bind="ltext: 'application.authorizedParties'">Valtuutetut</h3>
                <div data-bind="with: $root.application">
                  <ul data-bind="foreach: roles">
                    <li>
                      <span data-bind="text: firstName"></span> <span data-bind="text: lastName"></span>
                      (<span data-bind="text: username"></span>)
                      <i><span data-bind="foreach: roles"><span data-bind="text: loc($data)"></span> </span></i>
                      <i><span data-bind="if: $data.invite"><span class="user-invite" data-bind="text: loc('invited')"></span></span></i>
                      <span data-bind="visible: $root.application.isNotOwner($data)"><a class="remove-read" href="#" data-bind="ltext: 'remove', click: $root.application.removeAuth"></a></span>
                    </li>
                  </ul>
                </div>
                <br/>
              </div>
            </div>
          </div>

          <!-- docgen generated content: -->
          <div class="application_section">
            <div id="partiesDocgen">
              <!-- This is where generated document will be placed. -->
            </div>
          </div>

          <button
              data-bind="click: application.addParty, ltext: 'application.addParty'"
              class="btn btn-primary modal"
              data-test-id="add-party">
          </button>

          <div class="process-nav">
            <a class="btn process-next" data-bind="click: $root.application.nextTab" href="#" data-target="attachments"><span data-bind="ltext: 'application.next-tab'"></span><span class="icon drill-right-orange inline-right"></span></a>
            <a class="btn process-previous" data-bind="click: $root.application.nextTab" href="#" data-target="info"><span data-bind="ltext: 'application.previous-tab'"></span><span class="icon drill-left-black-bigger inline-left"></span></a>
          </div>

        </div>

        <div id="application-attachments-tab" class="tab-content">
          <h1 data-bind="ltext: 'application.tabAttachments'"></h1>
          <p data-bind="ltext: 'application.attachmentsDesc'" class="tab-info"></p>
          <div class="tab-wrapper">
            <div data-bind="if: attachmentsByGroup().length" data-test-id="application-attachments-table">

              <table class="table">
                <tbody data-bind="foreach: attachmentsByGroup">
                  <tr class="attachment-group-header">
                    <td data-bind="text: loc('attachmentType.' + group + '._group_label')" colspan="6"></td>
                  </tr>
                  <tr>
                    <th data-bind="ltext: 'application.attachmentState'">Tila</th>
                    <th data-bind="ltext: 'application.attachmentType'">Tyyppi</th>
                    <th data-bind="ltext: 'application.attachmentFile'">Tiedosto</th>
                    <th data-bind="ltext: 'application.attachmentVersion'">Versio</th>
                    <th data-bind="ltext: 'application.attachmentEditDate'">Muokattu</th>
                    <th></th>
                  </tr>

                  <!-- ko foreach: attachments -->
                  <tr style="cursor: pointer;">
                    <td class="attachmentState"><span data-bind="attr: {'class': statusName + ' icon', 'data-test-state': state, 'data-test-type': type['type-group'] + '.' + type['type-id']}"></span> </td>
                    <td data-bind="click: function() { window.location.hash='#!/attachment/' + $root.application.id() + '/' + id;}">
                      <a data-bind="attr: {href: '#!/attachment/' + $root.application.id() + '/' + id, 'data-test-type': type['type-group'] + '.' + type['type-id']}">
                        <span data-bind="if: type">
                          <span data-bind="text: loc('attachmentType.' + type['type-group'] + '.' + type['type-id'])"></span>
                        </span>
                        <span data-bind="if: !type">
                          <i data-bind="ltext: 'attachment.noName'"></i>
                        </span>
                      </a>
                    </td>
                    <td>
                      <span data-bind="if: $data.latestVersion">
                        <a href="#" data-bind="text: latestVersion.filename, attr: {href: '/api/download-attachment/' + latestVersion.fileId}"></a><br/>
                        <i data-bind="ltext: latestVersion.contentType"></i>
                        <i data-bind="size: latestVersion.size"></i>
                      </span>
                      <a data-bind="if: !$data.latestVersion, ltext: 'application.attachmentsAdd', attr: {href: '#!/attachment/' + $root.application.id() + '/' + id, 'data-test-type': type['type-group'] + '.' + type['type-id']}"></a>
                    </td>
                    <td>
                      <span data-bind="if: $data.latestVersion">
                        <span data-bind="version: latestVersion.version"></span>
                      </span>
                    </td>
                    <td>
                      <span data-bind="if: $data.latestVersion">
                      <span data-bind="dateString: modified"></span>
                        <span data-bind="fullName: latestVersion.user"></span>
                      </span>
                    </td>
                    <td>
                    </td>
                  </tr>
                <!-- /ko -->

                </tbody>
              </table>

              <a data-bind="attr: {href: '/api/download-all-attachments/' + $root.application.id()}, visible: application.hasAttachment, ltext: 'download-all'" data-test-id="application-download-all-attachement" href="#" target="_blank"></a>

            </div>
            <div data-bind="ifnot: attachmentsByGroup().length">
              <i data-bind="ltext: 'application.attachmentsEmpty'" data-test-id="application-attachments-no-attachments"></i>
            </div>
            <button
                data-bind="click: application.newAttachment, ltext: 'application.attachmentsAdd', visible: $root.authorization.ok('upload-attachment')"
                data-window-id="upload-dialog"
                class="btn btn-primary modal"
                data-test-id="add-attachment">
            </button>
            <button
                data-bind="click: attachmentTemplatesModel.show, ltext: 'application.newAttachmentTemplates', visible: $root.authorization.ok('create-attachments')"
                class="btn">
            </button>
          </div>
          <div class="process-nav">
            <a class="btn process-next" data-bind="click: $root.application.nextTab" href="#" data-target="conversation"><span data-bind="ltext: 'application.next-tab'"></span><span class="icon drill-right-orange inline-right"></span></a>
            <a class="btn process-previous" data-bind="click: $root.application.nextTab" href="#" data-target="parties"><span data-bind="ltext: 'application.previous-tab'"></span><span class="icon drill-left-black-bigger inline-left"></span></a>
          </div>
        </div>

        <div id="application-verdict-tab" class="tab-content">
          <h1 data-bind="ltext: 'application.tabVerdict'"></h1>
          <p data-bind="ltext: 'application.verdictDesc'" class="tab-info"></p>
          <div class="tab-wrapper" >
            <div class="row" data-bind="if: $root.verdictModel.verdicts()">
              <table class="table table-striped tablesorter" id="application-verdict-details">
                <thead>
                  <tr>
                    <th data-bind="ltext: 'verdict.id'"></th>
                    <th data-bind="ltext: 'verdict.status'"></th>
                    <th data-bind="ltext: 'verdict.name'"></th>
                    <th data-bind="ltext: 'verdict.given'"></th>
                    <th data-bind="ltext: 'verdict.official'"></th>
                    <th data-bind="ltext: 'verdict.attachments'"></th>
                  </tr>
                </thead>
                <tbody data-bind="foreach: $root.verdictModel.verdicts">
                  <tr class="statement-row">
                    <td data-bind="text: id, attr: {'data-test-id' : 'given-verdict-id-' + $index()}"></td>
                    <td data-bind="ltext: 'verdict.status.'+status"></td>
                    <td data-bind="text: name"></td>
                    <td data-bind="dateString: given"></td>
                    <td data-bind="dateString: official"></td>
                    <td data-bind="foreach: $root.verdictModel.attachments()">
                      <span data-bind="with: $data.latestVersion">
                        <a href="#" data-bind="text: filename, attr: {href: '/api/download-attachment/' + fileId}"></a><br/>
                          <i data-bind="ltext: contentType"></i>
                          <i data-bind="size: size"></i><br/>
                      </span>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
            <button
              data-bind="click: $root.verdictModel.openVerdict, ltext: 'application.verdict.add', visible: $root.authorization.ok('give-verdict')"
              class="btn btn-primary modal"
              data-test-id="give-verdict">
            </button>

          </div>
        </div>

        <div id="application-statement-tab" class="tab-content">

          <div data-bind="with: $root.application.data" class="application-statements">

            <h1 data-bind="ltext: 'application.statements'">Lausunnot</h1>
            <p data-bind="ltext: 'application.statementsDesc'" class="tab-info"></p>
            <div data-bind="ifnot: $data.statements && statements().length>0">
              <p data-bind="ltext: 'application.statement.missing'" data-test-id="application-no-statements"></p>
            </div>

            <div data-bind="if: $data.statements && statements().length>0">
              <table class="table table-striped tablesorter">
                <thead>
                  <tr>
                    <th data-bind="ltext: 'application.statement.desc'"></th>
                    <th data-bind="ltext: 'auth-admin.statement-person.name'"></th>
                    <th data-bind="ltext: 'application.statement.requested'"></th>
                    <th data-bind="ltext: 'application.statement.given'"></th>
                    <th data-bind="ltext: 'application.statement.status'"></th>
                  </tr>
                </thead>
                <tbody data-bind="foreach: $data.statements()">
                  <tr class="statement-row">
                    <td>
                      <span data-bind="if: status() || $root.authorization.ok('should-see-unsubmitted-statements')">
                        <a href="#" data-bind="text: person.text, click: $root.requestForStatementModel.openStatement, attr: {'data-test-id' : 'open-statement-' + $index()}"></a>
                      </span>
                      <span data-bind="ifnot: status() || $root.authorization.ok('should-see-unsubmitted-statements')">
                        <span data-bind="text: person.text, attr: {'data-test-id' : 'open-statement-' + $index()}"></span>
                      </span>
                    </td>
                    <td data-bind="text: person.name"></td>
                    <td data-bind="dateString: requested"></td>
                    <td data-bind="dateString: given"></td>
                    <td data-bind="text: status() && loc('statement.'+status())"></td>
                  </tr>
                </tbody>
              </table>
            </div>

            <button
                data-bind="click: $root.requestForStatementModel.openDialog, ltext: 'application.statement.add', visible: $root.authorization.ok('request-for-statement')"
                class="btn btn-primary modal"
                data-test-id="add-statement">
            </button>

          </div>

          <!-- feature flaggin' -->
          <div data-bind="if: features.enabled('neighbors')"><div class="feature"><span class="legend">neighbors</span>

          <div data-bind="with: application" class="application-neighbors">

            <h1 data-bind="ltext: 'application.neighbors'">Naapurit</h1>
            <p data-bind="ltext: 'application.neighborsDesc'" class="tab-info"></p>
            <div data-bind="ifnot: neighbors() && neighbors().length>0">
              <p data-bind="ltext: 'neighbors.missing'" data-test-id="application-no-neigbors"></p>
            </div>

            <div data-bind="if: neighbors() && neighbors().length>0">
              <table>
                <thead>
                  <tr>
                    <th data-bind="ltext: 'neighbors.propertyId'"></th>
                    <th data-bind="ltext: 'neighbors.owner'"></th>
                    <th data-bind="ltext: 'neighbors.status'"></th>
                    <th data-bind="ltext: 'neighbors.actions'"></th>
                  </tr>
                </thead>
                <tbody data-bind="foreach: neighbors">
                  <tr>
                    <td data-bind="text: neighbor.propertyId"></td>
                    <td data-bind="with: neighbor.owner">
                      <span data-bind="text: name" class="owner-name"></span>
                      <span data-bind="text: address.street" class="owner-street"></span>
                      <span data-bind="text: address.zip" class="owner-zip"></span>
                      <span data-bind="text: address.city" class="owner-city"></span>
                      <span data-bind="text: email" class="owner-email"></span>
                    </td>
                    <td>
                      <a data-bind="visible: $root.neighbor.statusHasData($data), click: $root.neighbor.showStatus" href="#">
                        <span data-bind="text: loc('neighbor.state', lastStatus.state())" class="status-state"></span>
                      </a>
                      <span data-bind="visible: !$root.neighbor.statusHasData($data), text: loc('neighbor.state', lastStatus.state())" class="status-state"></span>
                      <span data-bind="dateTimeString: lastStatus.created" class="status-time"></span>
                    </td>
                    <td>
                      <span data-bind="visible: $root.neighbor.statusPending($data)">
                        <a data-bind="click: $root.sendNeighborEmailModel.open, visible: $root.authorization.ok('neighbor-send-invite'), ltext: 'neighbors.actions.sendEmail'" class="command" href="#"></a>
                        <a data-bind="click: $root.neighbor.upload, ltext: 'neighbors.actions.upload', clickBubble: false" class="command" href="#"></a>
                        <a data-bind="click: $root.neighbor.markDone, visible: lastStatus.state() != 'mark-done' && $root.authorization.ok('neighbor-mark-done'), ltext: 'neighbors.actions.markDone', clickBubble: false" class="command" href="#"></a>
                      </span>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>

            <button data-bind="click: $root.neighbor.manage, ltext: 'neighbors.manage', visible: $root.authorization.ok('neighbor-add')" class="btn btn-primary modal" data-test-id="manage-neighbors"></button>

          </div>

          <!-- feature flaggin' -->
          </div></div>

        </div>

        <div id="application-conversation-tab" data-bind="with: $root.comment" class="tab-content" >
          <h1 data-bind="ltext: 'application.tabConversation'"></h1>
          <p data-bind="ltext: 'application.conversationDesc'" class="tab-info"></p>
          <div data-bind="template: {name: 'comment-template'}"></div>
          <div class="process-nav"></div>
        </div>

      </div>
    </div>
    <div id="boxes">

      <div id="dialog-valtuutus" class="window autosized">
        <div class="dialog-header">
          <p data-bind="ltext: 'application.addInvite'">Lis&auml;&auml; valtuutus</p>
          <p class="dialog-close close">X</p>
        </div>
        <div class="dialog-content">
          <p data-bind="ltext: 'invite.desc'" class="dialog-desc"> </p>
          <form data-bind="with: $root.invite">
            <!-- label data-bind="ltext: 'userinfo.role'" class="form-label" for="invite-document"></label -->
            <input class="form-input text long" id="invite-document-name" disabled="disabled" type="hidden" data-bind="value: documentName, valueUpdate: 'afterkeydown'" />
            <input class="form-input text long" id="invite-document-id" disabled="disabled" type="hidden" data-bind="value: documentId, valueUpdate: 'afterkeydown'" />
            <input class="form-input text long" id="invite-document-path" disabled="disabled" type="hidden" data-bind="value: path, valueUpdate: 'afterkeydown'" />
            <label data-bind="ltext: 'userinfo.email'" class="form-label" for="invite-email"></label>
            <input class="form-input text long" id="invite-email" type="text" data-bind="value: email, valueUpdate: 'afterkeydown'" />
            <label data-bind="ltext: 'application.inviteMessage'" class="form-label" for="invite-text"></label>
            <textarea id="invite-text" rows=10 class="form-input textarea really-long high" data-bind="value: text, valueUpdate: 'afterkeydown'"></textarea>
            <div data-bind="visible: error" >
              <div data-bind="text: error" class="context-error"></div>
            </div>
            <button class="btn btn-primary btn-dialog" data-test-id="application-invite-submit" data-bind="click: submit, ltext: 'application.inviteSend'"></button>
          </form>
        </div>
      </div>

      <div id="dialog-request-for-statement" class="window autosized">
        <div class="dialog-header">
         <p data-bind="ltext: 'application.statement.add'"></p>
         <p class="dialog-close close">X</p>
        </div>
        <div class="dialog-content" data-bind="with: $root.requestForStatementModel">
          <div data-bind="foreach: data()">
            <input class="form-input" type="checkbox" data-test-id="check-statement-person" data-bind="value: id, checked: $root.requestForStatementModel.personIds, valueUpdate: 'afterkeydown', attr: {'id': id, 'data-test-id' : 'check-statement-person-' + $index()}" />
            <label data-bind="text: text()+' '+name() + ' (' + email() + ')', attr: {'for': id}" class="form-label"></label><br/>
          </div>
          <button
              data-bind="click: send, ltext: 'application.statement.send', disable: disabled"
              class="btn btn-primary modal"
              data-test-id="add-statement-person">
          </button>
          <img class="own-info-ajax-loader" data-bind="visible: submitting" style="display: none" src="/img/ajax-loader-12.gif" alt="..." width="12" height="12"/>
        </div>
      </div>

      <div id="dialog-add-attachment-templates" class="window autosized selectm-dialog" style="width: 600px; height: 500px;">
        <div class="dialog-header">
          <p data-bind="ltext: 'application.newAttachmentTemplates'"></p>
          <p class="dialog-close close">X</p>
        </div>
        <div class="dialog-content">
          <div class="attachment-templates"></div>
        </div>
      </div>

      <div id="dialog-stamp-attachments" class="window autosized">
        <div data-bind="with: $root.stampModel">

          <div class="dialog-header">
            <p data-bind="ltext: 'stamp.title'"></p>
            <p class="dialog-close close">X</p>
          </div>

          <div class="dialog-content">

            <div class="stamp-margin">
              <table>
                <tbody>
                  <tr>
                    <td data-bind="ltext: 'stamp.margin'" colspan="3"></td>
                  </tr>
                  <tr>
                    <td data-bind="ltext: 'stamp.xMargin'" class="label"></td>
                    <td>
                      <input
                        data-bind="
                          value: xMargin,
                          enable: status() === statusReady,
                          valueUpdate: 'afterkeydown',
                          css: {'invalid-margin': !xMarginOk()}"
                        type="text"
                        class="form-input text"/>
                      </td>
                    <td>mm</td>
                  </tr>
                  <tr>
                    <td data-bind="ltext: 'stamp.yMargin'" class="label"></td>
                    <td>
                      <input
                        data-bind="
                          value: yMargin,
                          enable: status() === statusReady,
                          valueUpdate: 'afterkeydown',
                          css: {'invalid-margin': !yMarginOk()}"
                        type="text"
                        class="form-input text"/>
                      </td>
                    <td>mm</td>
                  </tr>
                  <tr>
                    <td data-bind="ltext: 'stamp.transparency'" class="label"></td>
                    <td colspan="2">
                      <select data-bind="options: transparencies, optionsText: 'text', value: transparency" class="form-input combobox"></select>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>

            <div class="stamp-files">
              <table>
                <thead>
                  <tr>
                    <th data-bind="ltext: 'stamp.filename'"></th>
                    <th data-bind="ltext: 'stamp.version'"></th>
                    <th data-bind="ltext: 'stamp.size'"></th>
                    <th data-bind="ltext: status() <= statusReady ? 'stamp.select' : 'stamp.status'"></th>
                  </tr>
                </thead>
                <tbody data-bind="foreach: files">
                  <tr>
                    <td data-bind="text: filename"></td>
                    <td>
                      <span data-bind="version: version"></span>
                      <span data-bind="visible: restamp">*</span>
                    </td>
                    <td data-bind="size: size"></td>
                    <td>
                      <input type="checkbox" data-bind="
                          checked: selected,
                          visible: $parent.status() < $parent.statusRunning,
                          enable: $parent.status() === $parent.statusReady" />
                      <span data-bind="
                          text: loc('stamp.file.status', status()),
                          visible: $parent.status() >= $parent.statusRunning"></span>
                    </td>
                  </tr>
                </tbody>
              </table>
              <div class="select-all">
                <a data-bind="ltext: 'stamp.all', click: selectAll" href="#"></a>
                <span>/</span>
                <a data-bind="ltext: 'stamp.none', click: selectNone" href="#"></a>
              </div>

              <form class="stamp-files-select-all-none">
              </form>
            </div>

            <div class="stamp-status">
              <span data-bind="text: loc('stamp.status', status().toString())"></span>
            </div>

            <div class="stamp-buttons">
              <button data-bind="
                  click: start,
                  ltext: 'stamp.start',
                  enable: status() === statusReady && xMarginOk() && yMarginOk() && selectedFiles().length > 0,
                  visible: status() <= statusReady"
                class="btn btn-primary btn-dialog">
              </button>
              <button data-bind="
                  ltext: 'stamp.cancel',
                  enable: status() === statusReady,
                  visible: status() <= statusReady"
                class="btn btn-dialog close">
              </button>
              <button data-bind="
                  ltext: 'stamp.ok',
                  visible: status() > statusRunning"
                class="btn btn-primary btn-dialog close"
                data-test-id="application-stamp-dialdog-ok">
              </button>
            </div>

          </div>
        </div>
      </div>

      <div id="dialog-send-neighbor-email" class="window autosized">
        <div data-bind="with: $root.sendNeighborEmailModel">
          <div class="dialog-header">
            <p data-bind="ltext: 'neighbors.sendEmail.title'"></p>
            <p class="dialog-close close">X</p>
          </div>
          <div class="dialog-content">

            <form>
              <label data-bind="ltext: 'neighbors.sendEmail.name'" class="form-label"></label>
              <span data-bind="text: name" class="form-input text long" id="neighbors-sendemail-name" ></span>

              <label data-bind="ltext: 'neighbors.sendEmail.email'" class="form-label" for="neighbors-sendemail-email"></label>
              <input data-bind="value: email, valueUpdate: 'afterkeydown', attr: {placeholder: loc('neighbors.sendEmail.email.placeholder')}" class="form-input text long" id="neighbors-sendemail-email" />

              <label data-bind="ltext: 'neighbors.sendEmail.message'" class="form-label" for="neighbors-sendemail-message"></label>
              <textarea
                data-bind="value: message, valueUpdate: 'afterkeydown', attr: {placeholder: loc('neighbors.sendEmail.message.placeholder')}"
                class="form-input textarea"
                id="neighbors-sendemail-message"
                rows="3"
                maxlength="4000">
              </textarea>
            </form>

            <button data-bind="click: send, ltext: 'neighbors.sendEmail.ok', enable: ok" class="btn btn-primary btn-dialog"></button>
            <button data-bind="ltext: 'neighbors.sendEmail.cancel'" class="btn btn-dialog close"></button>

          </div>
        </div>
      </div>

      <div id="dialog-add-party" class="window autosized">
        <div data-bind="with: $root.addPartyModel">
          <div class="dialog-header">
            <p data-bind="ltext: 'addParty.heading'"></p>
            <p class="dialog-close close">X</p>
          </div>
          <div class="dialog-content">
            <div>
              <select
                data-bind="options: partyDocumentNames(),
                           optionsText: function(item) { return loc('schemas.'  + item); },
                           optionsValue: function(item) { return item; },
                           value: documentName,
                           optionsCaption: loc('choose')"
                data-test-id="select-party-document">
              </select>
              <button data-bind="click: addParty, ltext: 'add', enable: addPartyEnabled()" class="btn btn-primary btn-dialog close" data-test-id="add-party-button"></button>
            </div>
          </div>
        </div>
      </div>
      
      <div id="dialog-neighbor-status" class="window autosized">
        <div class="dialog-header">
        <p data-bind="ltext: 'neighbors.status-dialog.title'"></p>
        <p class="dialog-close close">X</p>
      </div>
        <div data-bind="with: neighborStatusModel" class="dialog-content">

          <div>
            <span data-bind="ltext: 'neighbors.status-dialog.user.message'"></span>
            <table>
              <tbody>
                <tr>
                  <td data-bind="ltext: 'neighbors.status-dialog.user.firstname'"></td>
                  <td data-bind="text: firstname"></td>
                </tr>
                <tr>
                  <td data-bind="ltext: 'neighbors.status-dialog.user.lastname'"></td>
                  <td data-bind="text: lastname"></td>
                </tr>
                <tr>
                  <td data-bind="ltext: 'neighbors.status-dialog.user.userid'"></td>
                  <td data-bind="text: userid"></td>
                </tr>
                <tr>
                  <td data-bind="ltext: 'neighbors.status-dialog.user.time'"></td>
                  <td data-bind="dateTimeString: created"></td>
                </tr>
              </tbody>
            </table>
          </div>

          <div data-bind="visible: state() === 'response-given-ok'">
            <span data-bind="ltext: 'neighbors.status-dialog.ok-message'"></span>
          </div>

          <div data-bind="visible: state() === 'response-given-comments'">
            <div data-bind="ltext: 'neighbors.status-dialog.comments-message'"></div>
            <div data-bind="text: message"></div>
          </div>
          
          <button data-bind="ltext: 'neighbors.status-dialog.ok'" class="btn btn-primary btn-dialog close"></button>
        </div>
      </div>

    </div>
  </section>

</body>
</html>
