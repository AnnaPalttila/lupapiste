<!DOCTYPE html>
<html>
<body>
  <section class="page container" id="comments">
    <script type="text/html" id="comment-template">
      <table class="table table-striped conversation" data-test-id="comments-table">
        <tbody data-bind="foreach: comments()">
          <tr data-bind="attr: {'class': $parent.isForNewAttachment($data) ? 'comment attachment-comment' : 'comment'}">
            <td class="comment-party commenttd">
              <span class="date" data-bind="dateTimeString: created"></span>
              <br />
              <span class="author" data-bind="fullName: user">
              </span>
              <br />
              <b>(<span class="role" data-bind="ltext: user.role"></span>)</b>
            </td>
            <td class="comment comment-text">
              <span data-bind="if: $parent.isForNewAttachment($data)" class="new-attachment-version-details">
                <span data-bind="ltext: 'newAttachmentVersion'"></span>
                <span data-bind="version: target.version"></span>:
                <a data-bind="text: target.filename, attr: {href: '/api/raw/download-attachment?attachment-id=' + target.fileId()}"></a>
              </span>
              <span data-bind="text: text"></span>
            </td>
          </tr>
        </tbody>
      </table>
      <form>
        <h3 data-bind="ltext: 'application.conversationPrompt'">Kirjoita viesti:</h3>
        <textarea
          data-bind="attr: {placeholder: loc('comment.placeholder')}, value: text, valueUpdate: 'afterkeydown'"
          data-test-id="application-new-comment-text"
          class="form-input textarea"
          rows="3"
          maxlength="4000">
        </textarea>
        <button
          data-bind="disable: disabled, click: submit"
          data-test-id="application-new-comment-btn"
          type="submit"
          class="btn btn-primary">
          <span data-bind="ltext: 'application.conversationSend'"></span>
          <em data-bind="visible: pending" class="button-loader"></em>
        </button>
      </form>
    </script>
  </section>
</body>
