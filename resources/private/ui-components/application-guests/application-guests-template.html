<!DOCTYPE html>
<html>
  <body>
    <section class="page container">
      <script type="text/x-jquery-tmpl" id="application-guests-template">
        <div class="application-guests">
          <table class="auth-table"
                 data-bind="visible: allGuests">
            <thead>
              <th data-bind="ltext: 'application-guests.user'"></th>
              <th data-bind="ltext: 'application-guests.inviter'"></th>
              <th data-bind="ltext: 'guest-authority.role'"></th>
              <th data-bind="ltext: 'application-guests.notifications'"></th>
              <th data-bind="ltext: 'application-guests.remove'"></th>
            </thead>
            <tbody data-bind="foreach: allGuests">
              <tr>
                <td data-bind="text: $parent.nameAndUsername( $data )"></td>
                <td data-bind="text: inviter"></td>
                <td data-bind="text: authorityRole"></td>
                <td><a data-bind="visible: $parent.canModify( $data ),
                                  text: $parent.subscriptionLinkText( unsubscribed ),
                                  click: $parent.subscriptionLinkClick"></a></td>
                <td><i data-bind="visible: $parent.canModify( $data ),
                                  click: $parent.deleteGuest"
                       class="primary lupicon-remove"></i></td>
              </tr>
            </tbody>
          </table>
          <button class="positive" data-bind="click: toggleBubble">
            <i class="lupicon-circle-plus"></i>
            <span data-bind="ltext: 'guest-authority.add'"></span>
          </button>
          <bubble-dialog params="visible: bubbleVisible,
                                 buttonIcon: 'lupicon-circle-arrow-right',
                                 buttonText: 'application-guests.send',
                                 buttonEnabled: sendEnabled,
                                 okFun: send,
                                 waiting: waiting">
            <p data-bind="ltext: 'application-guests.info'"></p>
            <!-- ko if: $parent.isAuthority -->
            <label class="mandatory"
                   data-bind="ltext: 'application-guests.caption'"></label>
            <table class="mandatory">
              <tbody data-bind="foreach: $parent.guestAuthorities">
                <tr>
                  <td><input type="radio" name="guest-authorities"
                             data-bind="attr: {value: $data.email},
                                        checked: $parents[1].email" /></td>
                  <td class="full" data-bind="text: $data.name"></td>
                  <td class="full" data-bind="text: $data.email"></td>
                  <td class="full" data-bind="text: $data.role"></td>
                </tr>
              </tbody>
            </table>
            <!-- /ko -->
            <!-- ko ifnot: $parent.isAuthority -->
            <label data-bind="ltext: 'guest-authority.email',
                              attr: {'for': $parent.emailId}"
                   class="mandatory"></label>
            <input type="text" class="mandatory"
                   data-bind="textInput: $parent.email,
                              attr: {id: $parent.emailId}" />
            <!-- /ko -->
            <label data-bind="ltext: 'application-guests.message',
                              attr: {'for': $parent.messageId }"></label>
            <textarea data-bind="value: $parent.message,
                                 attr: {id: $parent.messageId}"></textarea>
            <div class="error"
                 data-bind="visible: $parent.guestError,
                            ltext: $parent.guestError"></div>
          </bubble-dialog>
        </div>
      </script>
    </section>
  </body>
</html>
