<!DOCTYPE html>
<html>
  <body>
    <section class="page container">
      <script type="text/x-jquery-tmpl" id="application-guests-template">
        <div class="application-guests">
          <table class="auth-table"
                 data-bind="visible: allGuests().length">
            <thead>
              <th data-bind="ltext: 'application-guests.user'"></th>
              <th data-bind="ltext: 'application-guests.inviter'"></th>
              <th data-bind="ltext: 'guest-authority.role'"></th>
              <!-- ko if: show.subscribeColumn -->
              <th data-bind="ltext: 'application-guests.notifications'"></th>
              <!-- /ko -->
              <!-- ko if: canDelete() -->
              <th data-bind="ltext: 'application-guests.remove'"></th>
              <!-- /ko -->
            </thead>
            <tbody data-bind="foreach: allGuests">
              <tr>
                <td data-bind="text: $parent.nameAndUsername( $data )"></td>
                <td data-bind="text: inviter"></td>
                <td data-bind="text: authorityRole"></td>
                <!-- ko if: $parent.show.subscribeColumn -->
                <td><a data-bind="visible: $parent.canSubscribe( $data ),
                                  text: $parent.subscriptionLinkText( unsubscribed ),
                                  click: $parent.subscriptionLinkClick"></a></td>
                <!-- /ko -->
                <!-- ko if: $parent.canDelete() -->
                <td><i data-bind="visible: $parent.canDelete( $data ),
                                  click: $parent.deleteGuest"
                       class="primary lupicon-remove"></i></td>
                <!-- /ko -->
              </tr>
            </tbody>
          </table>
          <button class="positive"
                  data-bind="click: toggleBubble,
                             visible: canDelete()">
            <i class="lupicon-circle-plus"></i>
            <span data-bind="ltext: 'guest-authority.add'"></span>
          </button>
          <bubble-dialog params="visible: bubbleVisible,
                                 buttonIcon: 'lupicon-circle-arrow-right',
                                 buttonText: 'application-guests.send',
                                 buttonEnabled: sendEnabled,
                                 okFun: send,
                                 waiting: waiting">
            <p data-bind="ltext: 'application-guests.info'"></p>
            <!-- ko if: $parent.isAuthority -->
            <div data-bind="visible: $parent.show.inviteTable">
              <label class="mandatory"
                     data-bind="ltext: 'application-guests.caption'">
              </label>
              <table class="mandatory">
                <tbody data-bind="foreach: $parent.guestAuthorities">
                  <tr>
                    <td><input type="radio" name="guest-authorities"
                               data-bind="attr: {value: $data.email},
                                          checked: $parents[1].email" /></td>
                    <td class="full" data-bind="text: $data.name"></td>
                    <td class="full" data-bind="text: $data.email"></td>
                    <td class="full" data-bind="text: $data.role"></td>
                  </tr>
                </tbody>
              </table>
            </div>
            <!-- /ko -->
            <!-- ko ifnot: $parent.isAuthority -->
            <label data-bind="ltext: 'guest-authority.email',
                              attr: {'for': $parent.emailId}"
                   class="mandatory"></label>
            <input type="text" class="mandatory"
                   data-bind="textInput: $parent.email,
                              attr: {id: $parent.emailId}" />
            <!-- /ko -->
            <div data-bind="visible: $parent.show.inviteMessage">
              <label data-bind="ltext: 'application-guests.message',
                                attr: {'for': $parent.messageId }"></label>
              <textarea data-bind="value: $parent.message,
                                   attr: {id: $parent.messageId}"></textarea>
            </div>
            <div class="error"
                 data-bind="visible: $parent.error,
                            ltext: $parent.error"></div>
          </bubble-dialog>
        </div>
      </script>
    </section>
  </body>
</html>
